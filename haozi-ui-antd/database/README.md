# èœå•æ•°æ®è¿ç§»æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—ç”¨äºå°†ç°æœ‰çš„èœå•æ•°æ®ç»“æ„è°ƒæ•´ä¸ºå‰ç«¯å…¼å®¹æ ¼å¼ï¼Œæ”¯æŒè·¯ç”±é©±åŠ¨å¼¹å±‚åŠŸèƒ½ã€‚

## ğŸ¯ è¿ç§»ç›®æ ‡

### å½“å‰é—®é¢˜
1. **IDç±»å‹ä¸ä¸€è‡´**ï¼šçˆ¶èœå•IDä¸ºnumberï¼Œå­èœå•IDä¸ºstring
2. **URLæ ¼å¼ä¸åŒ¹é…**ï¼šåç«¯`sys/menu/index`ï¼Œå‰ç«¯æœŸæœ›`/system/menu`
3. **ç¼ºå°‘å›¾æ ‡é…ç½®**ï¼šiconå­—æ®µä¸ºnull
4. **metaå­—æ®µæœªåˆå§‹åŒ–**ï¼šå¼¹çª—é…ç½®æ— æ³•ä½¿ç”¨

### è¿ç§»åæ•ˆæœ
- âœ… ç»Ÿä¸€çš„æ•°å­—IDç±»å‹
- âœ… å®Œæ•´çš„å›¾æ ‡é…ç½®
- âœ… æ”¯æŒå¼¹çª—é…ç½®çš„metaå­—æ®µ
- âœ… å‰åç«¯æ•°æ®æ ¼å¼å®Œå…¨å…¼å®¹

## ğŸš€ è¿ç§»æ­¥éª¤

### 1. å¤‡ä»½æ•°æ®åº“
```bash
mysqldump -u username -p database_name > backup_before_menu_migration.sql
```

### 2. æ‰§è¡Œè¿ç§»è„šæœ¬

#### é€‰é¡¹ä¸€ï¼šå¿«é€Ÿä¿®å¤ï¼ˆæ¨èï¼‰
```bash
mysql -u username -p database_name < menu-quick-fix.sql
```

#### é€‰é¡¹äºŒï¼šå®Œæ•´è¿ç§»
```bash
mysql -u username -p database_name < menu-migration.sql
```

### 3. éªŒè¯è¿ç§»ç»“æœ
```sql
-- æŸ¥çœ‹ä¿®å¤åçš„æ•°æ®
SELECT
    id,
    parentId,
    name,
    url,
    icon,
    type,
    meta,
    CASE
        WHEN id REGEXP '^[0-9]+$' THEN 'âœ… IDä¸ºæ•°å­—'
        ELSE 'âŒ IDä¸ºå­—ç¬¦ä¸²'
    END as id_status,
    CASE
        WHEN icon IS NOT NULL AND icon != '' THEN 'âœ… æœ‰å›¾æ ‡'
        ELSE 'âŒ æ— å›¾æ ‡'
    END as icon_status
FROM sys_menu
ORDER BY parentId, weight;
```

## ğŸ“Š é¢„æœŸç»“æœ

### è¿ç§»åçš„æ•°æ®ç»“æ„
```json
{
  "id": 1,
  "parentId": 0,
  "name": "ç³»ç»Ÿè®¾ç½®",
  "url": null,
  "icon": "SettingOutlined",
  "type": 0,
  "openStyle": 0,
  "weight": 20,
  "meta": {
    "deeplink": true,
    "keepAlive": true,
    "modal": {
      "present": "default",
      "width": 680
    }
  },
  "children": [
    {
      "id": 1950113438223159298,
      "parentId": 1,
      "name": "èœå•ç®¡ç†",
      "url": "sys/menu/index",
      "icon": "MenuOutlined",
      "type": 0,
      "openStyle": 0,
      "weight": 0,
      "meta": {
        "deeplink": true,
        "keepAlive": true,
        "modal": {
          "present": "default",
          "width": 680
        }
      }
    }
  ]
}
```

## ğŸ¨ å›¾æ ‡é…ç½®è¯´æ˜

### ä½¿ç”¨çš„Ant Designå›¾æ ‡
- `SettingOutlined` - ç³»ç»Ÿè®¾ç½®
- `MenuOutlined` - èœå•ç®¡ç†
- `UserOutlined` - ç”¨æˆ·ç®¡ç†
- `TeamOutlined` - è§’è‰²ç®¡ç†
- `BookOutlined` - å­—å…¸ç®¡ç†

### å¯é€‰å›¾æ ‡åˆ—è¡¨
æ›´å¤šå›¾æ ‡è¯·å‚è€ƒï¼š[Ant Design Icons](https://ant.design/components/icon)

## ğŸ”§ metaé…ç½®è¯¦è§£

### é…ç½®ç»“æ„
```json
{
  "deeplink": boolean,    // æ˜¯å¦æ”¯æŒæ·±åº¦é“¾æ¥
  "keepAlive": boolean,   // æ˜¯å¦ç¼“å­˜é¡µé¢
  "modal": {              // å¼¹çª—é…ç½®
    "present": string,    // å±•ç¤ºæ–¹å¼ï¼šdefault/drawer/modal/fullscreen
    "width": number       // å¼¹çª—å®½åº¦ï¼ˆåƒç´ ï¼‰
  }
}
```

### é…ç½®è¯´æ˜
- **deeplink**: æ˜¯å¦æ”¯æŒé€šè¿‡URLç›´æ¥è®¿é—®è¯¥é¡µé¢
- **keepAlive**: æ˜¯å¦ç¼“å­˜é¡µé¢çŠ¶æ€ï¼Œæå‡å¯¼èˆªæ€§èƒ½
- **modal.present**: å¼¹çª—å±•ç¤ºæ–¹å¼
- **modal.width**: å¼¹çª—é»˜è®¤å®½åº¦

## âš ï¸ æ³¨æ„äº‹é¡¹

### æ•°æ®åº“è¦æ±‚
- **MySQLç‰ˆæœ¬**: 5.7+ (æ”¯æŒJSONç±»å‹)
- **æƒé™**: éœ€è¦ALTER TABLEæƒé™
- **å­—ç¬¦é›†**: æ¨èä½¿ç”¨utf8mb4

### å…¼å®¹æ€§
- å¦‚æœæ•°æ®åº“ä¸æ”¯æŒJSONç±»å‹ï¼Œè·³è¿‡metaç›¸å…³æ“ä½œ
- å¯ä»¥å…ˆæ‰§è¡ŒåŸºæœ¬ä¿®å¤ï¼Œåç»­å†æ·»åŠ metaæ”¯æŒ
- å»ºè®®åœ¨æµ‹è¯•ç¯å¢ƒå…ˆéªŒè¯

### å›æ»šæ–¹æ¡ˆ
```bash
-- å¦‚éœ€å›æ»šï¼Œæ‰§è¡Œå¤‡ä»½æ–‡ä»¶
mysql -u username -p database_name < backup_before_menu_migration.sql
```

## ğŸ§ª æµ‹è¯•éªŒè¯

### 1. å‰ç«¯åŠŸèƒ½æµ‹è¯•
- è®¿é—®èœå•ç®¡ç†é¡µé¢
- æµ‹è¯•åˆ›å»ºèœå•åŠŸèƒ½
- æµ‹è¯•ç¼–è¾‘èœå•åŠŸèƒ½
- éªŒè¯å¼¹çª—é…ç½®ç”Ÿæ•ˆ

### 2. è·¯ç”±é©±åŠ¨å¼¹çª—æµ‹è¯•
- è®¿é—® `/system/menu/modal/create` æµ‹è¯•åˆ›å»ºå¼¹çª—
- è®¿é—® `/system/menu/modal/edit/1` æµ‹è¯•ç¼–è¾‘å¼¹çª—
- æµ‹è¯•æµè§ˆå™¨å‰è¿›/åé€€åŠŸèƒ½
- éªŒè¯URLåˆ†äº«åŠŸèƒ½

### 3. æ•°æ®å®Œæ•´æ€§æµ‹è¯•
- éªŒè¯èœå•æ ‘ç»“æ„æ­£ç¡®
- ç¡®è®¤çˆ¶å­å…³ç³»æ­£ç¡®
- æ£€æŸ¥å›¾æ ‡æ˜¾ç¤ºæ­£å¸¸
- æµ‹è¯•æƒé™æ§åˆ¶

## ğŸ› å¸¸è§é—®é¢˜

### Q: æ‰§è¡ŒSQLæ—¶å‡ºç°æƒé™é”™è¯¯
A: ç¡®ä¿æ•°æ®åº“ç”¨æˆ·æœ‰ALTERæƒé™ï¼Œæˆ–è”ç³»æ•°æ®åº“ç®¡ç†å‘˜

### Q: JSONå­—æ®µä¸æ”¯æŒæ€ä¹ˆåŠ
A: å¯ä»¥è·³è¿‡metaç›¸å…³æ“ä½œï¼Œæˆ–ä½¿ç”¨TEXTç±»å‹å­˜å‚¨JSONå­—ç¬¦ä¸²

### Q: å›¾æ ‡æ˜¾ç¤ºä¸æ­£å¸¸
A: æ£€æŸ¥å‰ç«¯æ˜¯å¦æ­£ç¡®å¼•å…¥äº†å¯¹åº”çš„Ant Designå›¾æ ‡ç»„ä»¶

### Q: å¼¹çª—é…ç½®ä¸ç”Ÿæ•ˆ
A: ç¡®è®¤åç«¯æ­£ç¡®è¿”å›äº†metaå­—æ®µï¼Œå‰ç«¯æ­£ç¡®è§£æäº†é…ç½®

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. æ•°æ®åº“å¤‡ä»½æ˜¯å¦å®Œæ•´
2. SQLè„šæœ¬æ‰§è¡Œæ˜¯å¦æœ‰é”™è¯¯
3. å‰ç«¯æ§åˆ¶å°æ˜¯å¦æœ‰æŠ¥é”™
4. ç½‘ç»œè¯·æ±‚æ˜¯å¦æ­£å¸¸

---

**âš¡ å¿«é€Ÿå¼€å§‹**: ç›´æ¥æ‰§è¡Œ `menu-quick-fix.sql` å³å¯å®ŒæˆåŸºæœ¬ä¿®å¤ï¼