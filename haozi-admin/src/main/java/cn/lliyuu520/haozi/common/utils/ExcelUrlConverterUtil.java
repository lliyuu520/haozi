package cn.lliyuu520.haozi.common.utils;import cn.hutool.core.collection.CollUtil;import com.alibaba.excel.converters.Converter;import com.alibaba.excel.enums.CellDataTypeEnum;import com.alibaba.excel.metadata.GlobalConfiguration;import com.alibaba.excel.metadata.data.ImageData;import com.alibaba.excel.metadata.data.WriteCellData;import com.alibaba.excel.metadata.property.ExcelContentProperty;import com.alibaba.excel.util.IoUtils;import cn.lliyuu520.haozi.common.dto.FileDTO;import java.net.URL;import java.util.ArrayList;import java.util.List;/** * * @author liliangyu */public class ExcelUrlConverterUtil implements Converter<List<FileDTO>> {@Overridepublic CellDataTypeEnum supportExcelTypeKey() {    return CellDataTypeEnum.STRING;}@Overridepublic WriteCellData<?> convertToExcelData(List<FileDTO> fileDTOList, ExcelContentProperty contentProperty, GlobalConfiguration globalConfiguration) {    WriteCellData writeCellData = new WriteCellData();    if(CollUtil.isEmpty(fileDTOList)){        writeCellData.setType(CellDataTypeEnum.STRING);        writeCellData.setStringValue("暂无图片");        return new WriteCellData<>();    }    final List<String> list = fileDTOList.stream().map(FileDTO::getUrl).toList();    List<ImageData> imageDataList = new ArrayList<>();    for (String url : list) {        try {            URL imageUrl = new URL(url);            byte[] bytes = IoUtils.toByteArray(imageUrl.openConnection().getInputStream());            ImageData imageData = new ImageData();            imageData.setImage(bytes);            imageDataList.add(imageData);        } catch (Exception e) {            e.printStackTrace();        }    }    writeCellData.setImageDataList(imageDataList);    writeCellData.setType(CellDataTypeEnum.STRING);    return writeCellData;}}